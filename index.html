<!DOCTYPE html>
<html lang="ja">
	<head>
		<a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-url="https://yuyaokayama.github.io/sikoreNightTheater/" data-show-count="false">Tweet</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
		<meta charset=utf-8>
		<title>SikoreNightTheater</title>
		<h1>SikoreNightTheater</h1>
	</head>


	<body>

		<div>
		    <input type="file" id="input">
		</div>
		<div>
		    <video id="video" width="1000" height="800"></video>
		</div>

		<div style="width:500px; background-color:#333333; color:#ffffff;">
			<p id = "keys">　a, s, d, f, u, i, o を押下している間、動画が再生されます</p>
		</div>


		<script type="text/javascript">
			var elem = document.getElementById("keys");
			var input = document.querySelector('#input')
			var video = document.querySelector('#video')
			var aFlag = false;
			var hFlag = false;
			var dFlag = false;
			var fFlag = false;
			var sFlag = false;
			var mFlag = false;
			var oFlag = false;

			document.addEventListener("keydown", keyDownFun);
			document.addEventListener("keyup", keyUpFun);
			setInterval(playVideo, 1000/10);


			input.onchange = function(){        
		        if(this.files && this.files.length){
		            tryVideo( this.files[0] );
		        }
		    };

			
			function keyDownFun(e){
				console.log(e.keyCode);
		
				if(e.keyCode == 65 ){
					aFlag = true;
				}

				if(e.keyCode == 83 ){
					sFlag = true;
				}

				if(e.keyCode == 85 ){
					uFlag = true;
				}

				if(e.keyCode == 68 ){
					dFlag = true;
				}

				if(e.keyCode == 70 ){
					fFlag = true;
				}

				if(e.keyCode == 73 ){
					iFlag = true;
				}

				if(e.keyCode == 79 ){
					oFlag = true;
				}	
				
			}

			function keyUpFun(e){
				console.log("up" + e.keyCode);
				
				if(e.keyCode == 65 ){
					aFlag = false;
					keys[0] == " ";
				}

				if(e.keyCode == 83 ){
					sFlag = false;
				}

				if(e.keyCode == 85 ){
					uFlag = false;
				}

				if(e.keyCode == 68 ){
					dFlag = false;
				}

				if(e.keyCode == 70 ){
					fFlag = false;
				}

				if(e.keyCode == 73 ){
					iFlag = false;
				}

				if(e.keyCode == 79 ){
					oFlag = false;
				}
				
			}
			

			function tryVideo(file){  
		        video.src = URL.createObjectURL(file);
		    }

			function playVideo(){
				//すべてのキーが押されていることを確認する
				if(aFlag && sFlag && iFlag && dFlag && fFlag && oFlag && oFlag){
					//動画を再生
					video.play();
				}
				else video.pause();
			}


		</script>
	</body> 
</html>